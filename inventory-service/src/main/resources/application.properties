# Quarkus Application Configuration
quarkus.application.name=inventory-service
quarkus.application.version=1.0.0-SNAPSHOT

# HTTP Server Configuration
quarkus.http.port=8083
quarkus.http.root-path=/api

# Database Configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=postgres
quarkus.datasource.password=postgres
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/inventorydb
quarkus.datasource.jdbc.max-pool-size=10
quarkus.datasource.jdbc.min-pool-size=2
quarkus.datasource.jdbc.idle-timeout=30S
quarkus.datasource.jdbc.max-lifetime=20M
quarkus.datasource.jdbc.connection-timeout=30S
# auto-commit is handled by transaction management
quarkus.datasource.jdbc.transactions=enabled

quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.format-sql=true
quarkus.hibernate-orm.dialect=org.hibernate.dialect.PostgreSQLDialect
quarkus.hibernate-orm.sql-load-script=no-file

# Flyway Configuration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.locations=classpath:db/migration
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.table=flyway_schema_history
quarkus.flyway.baseline-version=1
quarkus.flyway.validate-on-migrate=true
# quarkus.flyway.clean-disabled=true # This property is not directly available in Quarkus Flyway, manage through profile if needed

# Kafka Configuration
kafka.bootstrap.servers=kafka:29092

# Incoming channels
mp.messaging.incoming.order-events.connector=smallrye-kafka
mp.messaging.incoming.order-events.topic=order-events
mp.messaging.incoming.order-events.group.id=inventory-service-group
mp.messaging.incoming.order-events.auto.offset.reset=earliest
mp.messaging.incoming.order-events.value.deserializer=io.quarkus.kafka.client.serialization.JsonbDeserializer
mp.messaging.incoming.order-events.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer

mp.messaging.incoming.product-events.connector=smallrye-kafka
mp.messaging.incoming.product-events.topic=product-events
mp.messaging.incoming.product-events.group.id=inventory-service-group
mp.messaging.incoming.product-events.auto.offset.reset=earliest
mp.messaging.incoming.product-events.value.deserializer=io.quarkus.kafka.client.serialization.JsonbDeserializer
mp.messaging.incoming.product-events.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer

# Outgoing channels
mp.messaging.outgoing.inventory-events.connector=smallrye-kafka
mp.messaging.outgoing.inventory-events.topic=inventory-events
mp.messaging.outgoing.inventory-events.value.serializer=io.quarkus.kafka.client.serialization.JsonbSerializer
mp.messaging.outgoing.inventory-events.key.serializer=org.apache.kafka.common.serialization.StringSerializer
mp.messaging.outgoing.inventory-events.acks=all
mp.messaging.outgoing.inventory-events.retries=3
mp.messaging.outgoing.inventory-events.batch.size=16384
mp.messaging.outgoing.inventory-events.buffer.memory=33554432
mp.messaging.outgoing.inventory-events.linger.ms=10
mp.messaging.outgoing.inventory-events.enable.idempotence=true

# REST Client Configuration (for product-service, if needed)
# quarkus.rest-client.product-service.url=http://product-service:8081/api
# org.eclipse.microprofile.rest.client.inject.product-service.connect-timeout=5000
# org.eclipse.microprofile.rest.client.inject.product-service.read-timeout=5000

# Distributed Tracing (OpenTelemetry)
quarkus.opentelemetry.tracer.sampler.parent-based.ratio=1.0
quarkus.opentelemetry.tracer.exporter.otlp.endpoint=http://zipkin:4317

# Health Check
quarkus.smallrye-health.root-path=/q/health

# Metrics
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics
quarkus.micrometer.binder.http-server.enabled=true
quarkus.micrometer.common-tags=application=inventory-service,region=${REGION:unknown},environment=${ENV:local}

# OpenAPI
quarkus.smallrye-openapi.path=/q/openapi
quarkus.swagger-ui.path=/q/swagger-ui
quarkus.swagger-ui.always-include=true
mp.openapi.extensions.smallrye.info.title=Inventory Service API Documentation
mp.openapi.extensions.smallrye.info.description=REST API documentation for Inventory Service
mp.openapi.extensions.smallrye.info.version=1.0.0
mp.openapi.extensions.smallrye.info.license.name=Apache 2.0
mp.openapi.extensions.smallrye.info.license.url=https://www.apache.org/licenses/LICENSE-2.0

# Logging
quarkus.log.level=INFO
# Not applicable for Quarkus, but kept for reference
# quarkus.log.category."org.springframework.web".level=INFO
quarkus.log.category."com.ecommerce.inventory".level=DEBUG
quarkus.log.category."org.hibernate.SQL".level=DEBUG
quarkus.log.category."org.hibernate.type.descriptor.sql.BasicBinder".level=TRACE

# Fault Tolerance (Circuit Breaker and Retry)
# Circuit Breaker for productService (example, if a client was defined)
# quarkus.fault-tolerance.circuit-breaker.productService.request-volume-threshold=10
# quarkus.fault-tolerance.circuit-breaker.productService.failure-ratio=0.5
# quarkus.fault-tolerance.circuit-breaker.productService.delay=10S
# quarkus.fault-tolerance.circuit-breaker.productService.success-threshold=3
# quarkus.fault-tolerance.circuit-breaker.productService.timeout=5S

# Retry for productService (example, if a client was defined)
# quarkus.fault-tolerance.retry.productService.max-retries=3
# quarkus.fault-tolerance.retry.productService.delay=1000
# quarkus.fault-tolerance.retry.productService.max-duration=5000

# Cache Configuration
quarkus.cache.caffeine.inventoryItems.initial-capacity=100
quarkus.cache.caffeine.inventoryItems.maximum-size=1000
quarkus.cache.caffeine.inventoryItems.expire-after-write=5M

quarkus.cache.caffeine.inventoryStatus.initial-capacity=100
quarkus.cache.caffeine.inventoryStatus.maximum-size=1000
quarkus.cache.caffeine.inventoryStatus.expire-after-write=5M

quarkus.cache.caffeine.stockLevels.initial-capacity=100
quarkus.cache.caffeine.stockLevels.maximum-size=1000
quarkus.cache.caffeine.stockLevels.expire-after-write=5M
